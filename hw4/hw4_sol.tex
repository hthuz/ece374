\documentclass[12pt,a4paper]{article}
\usepackage{fullpage}
\usepackage{amsmath}
% \usepackage[
%   backend=biber,
%   style=alphabetic,
%   sorting=ynt
% ]{biblatex}

\pagestyle{plain}
% choose any of the following packages to support AmsTeX
%\usepackage{amsmath,amssymb,amsfonts,mathrsfs,mathptm,bm,mathtools}
% choose the following package to insert eps figures
% for png, jpg or pdf figures, use pdflatex
%\usepackage{graphicx}

\newcommand{\question}[1]{\bigskip\noindent{\textbf{Q{#1} solution}}}

% set HW number
\newcommand{\HWnum}{4}

% specify first and last name and the ID number of students in the group
% append asterix to indicate who is making the submission
\newcommand{\StudentA}{Hanggang Zhu$^\ast$, 3200110457}
\newcommand{\StudentB}{Suhao Wang, 3200110777}
\newcommand{\StudentC}{Lumeng Xu 3200110184}

% ===============================================================
\begin{document}

%%% header
{\noindent \rule{\linewidth}{0.2mm}}
\noindent{ECE 374, ZJUI, Spring 2023\hfill%
  \textbf{\large H{}W\HWnum\ Solutions} \hfill \today\smallskip}

\noindent{\hfill \StudentA, \StudentB, and \StudentC \hfill}
\\[-0.2cm]{\noindent \rule{\linewidth}{0.2mm}}
%%% end header

\question{10.A}\\
Let $F$ be the language $\{ba^{2n}\ \vline\ n \ge 0\}$. \\
Let $x$ and $y$ be arbitrary strings in $F$. \\
Then $x=ba^{2i}$ and $y=ba^{2j}$ for some non-negative integers $i\neq j$. Assume $j > i$. \\
Let $z=ba^{i}$. \\
Then $xz=ba^{2i}ba^{i} \in L$ as $ba^i$ is the string formed by odd characters of $ba^{2i}$ \\ 
And $yz = ba^{2j}ba^{i}\notin L$ as $i \neq j$ \\
Thus, $F$ is a fooling set for $L$. \\
Because $F$ is infinite, $L$ cannot be regular. \\


\question{10.B}\\
$\bullet$ \textbf{set:}\\
Let $L_0=\{0^k1^k \ \vline\ k \ge 0\}$, let $L=L_0 \cup$ \{bitstrings with number of 0s is twice that of 1s\}, L is not regular.\\
$\bullet$ \textbf{proof:}\\
Let $F$ be the language $\{0^n\ \vline\ n \ge 0\}$. \\
Let $x$ and $y$ be arbitrary strings in $F$. \\
Then $x=0^{i}$ and $y=0^{j}$ for some non-negative integers $i\neq j$ and $2i\neq j$. Assume $j > i$. \\
Let $z=1^{i}$. \\
Then $xz=0^{i}1^{i} \in L$. \\ 
And $yz = 0^{j}1^{i}\notin L$. \\
Thus, $F$ is a fooling set for $L$. \\
Because $F$ is infinite, $L$ cannot be regular. \\

\noindent
$\bullet$ \textbf{set:}\\
Let $L_1=\overline{L_0}$, the complement of $L_0$, let $L'=L_1 \cup$ \{bitstrings with number of 0s is twice that of 1s\}, L' is not regular.\\
$\bullet$ \textbf{proof:}\\
Let $F$ be the language $\{0^n\ \vline\ n \ge 0\}$. \\
Let $x$ and $y$ be arbitrary strings in $F$. \\
Then $x=0^{i}$ and $y=0^{j}$ for some non-negative integers $i\neq j$ and $2i\neq j$. Assume $j > i >1$. \\
Let $z=1^{i}$. \\
Then $xz=0^{i}1^{i} \notin L'$. \\ 
And $yz = 0^{j}1^{i}\in L'$. \\
Thus, $F$ is a fooling set for $L'$. \\
Because $F$ is infinite, $L'$ cannot be regular. \\

\noindent
$\bullet$ \textbf{counter-example:}\\
L and L' are not regular, $L \cup L' = (0+1)^* $ is regular.
However, $L \cap L' =$ \{bitstrings with number of 0s is twice that of 1s\} is non-regular.


\question{10.C}\\
According to the closure properties, if $L1$, $L2$ are regular then $L1 \cup L2$ is regular. If $L1$, $L2$ are regular then $L1 \cap L2$ is regular.\\
Because for all $i \ne j$, $L_i \backslash L_j$ is regular:\\\\
$\bullet$ Set $L_4 = (L_1 \backslash L_2) \cup (L_1 \backslash L_3)$ is regular.\\
$\bullet$ Set $L_5 = (L_2 \backslash L_1) \cup (L_2 \backslash L_3)$ is regular.\\
$\bullet$ Set $L_6 = (L_3 \backslash L_1) \cup (L_3 \backslash L_2)$ is regular.\\\\
Assume $(L_1 \cap L_2 \cap L_3)$ is regular.\\
Then $(L_1 \cap L_2 \cap L_3) \cup L_4 \cup L_5 \cup L_6= (L_1 \cup L_2 \cup L_3)  $ should be regular. \\
However, $(L_1 \cup L_2 \cup L_3)$ is not regular.\\
Thus, $(L_1 \cap L_2 \cap L_3)$ is not regular.

\question{11.A}
\\First, consider the special case where $i=0$.
\\Then, this language can be written as $L=\{b^j c^k d^l | j,k,l \geq 0$ and $j+l=k\}$.
\\And we get the CFL:
\begin{center}
  $S \rightarrow AB$
  \\$A \rightarrow bAc | \epsilon$
  \\$B \rightarrow cBd | \epsilon$
\end{center}
Then, we consider another special case where $j=i$.
\\Then, we get $k=l$. And this language can be written as $L=\{a^j b^j c^k d^k | j,k \geq 0\}$.
\\And we get the CFL:
\begin{center}
  $S \rightarrow AB $
\\$A \rightarrow aAb | \epsilon$
\\$B \rightarrow cBd | \epsilon$
\end{center}
We found that in both cases, it has the equation $B \rightarrow cBd | \epsilon$, so we guess that in general case, 
we also have this equation.
\\
\\By induction, we get the general case:
\begin{center}
  $S \rightarrow ABC $
\\$A \rightarrow aAb | \epsilon$
\\$B \rightarrow bBc | \epsilon$
\\$C \rightarrow cCd | \epsilon$
\end{center}
To confirm its validity, we found that the number of $a$ plus the number of $c$ is 
equal to the number of $b$ plus the number of $d$, which satisfie the requirement. 
\\So, we conclude this answer. 
\\
\question{11.B}
\\First, we consider the case when only $\omega_i = a$.
\\In this case, the string only has $a$, so it must satisfy the condition 
for $L_B$.
\\Then, we consider the case $\omega_i$ is a balanced string or $\omega_i = a$. 
\\By definition, 
$\omega$ satisfies the condition $\#_a(\omega) \geq \#_b(\omega)$. When $\#_a(\omega)=\#_b(\omega)$,
we can know that $\omega$ can be at least divided to one balanced string $\omega_i$. 
When $\#_a(\omega) > \#_b(\omega)$, we can split the string to at least one balanced string and 
several $a$s. So, it satisfies this condition.
\\
\question{11.C}
\\For the above condition, we conclude that the CFG can be expressed as:
\begin{center}
  $S \rightarrow abS | aSb | Sab | SS | \epsilon $
\end{center}
For $S \rightarrow abS $, $a$ always appears before $b$, so,it satisfies $L_B$.
\\For $S \rightarrow aSb $, it also satisfies that $a$ always appears before $b$.
\\For $S \rightarrow Sab $, $a$ always appears before $b$.
\\For $S \rightarrow SS $, no matter what the value of $S$ is, it always satisfies
$a$ always appears before $b$, which satisfies $L_B$.
\\For $S \rightarrow \epsilon $, the empty string does not change the number of $a$ and
$b$.
\\So, the correctness of the CFG is proved.
\\
\question{12.A}

The context free language for palindrome is easily derived as follows:
\begin{align}
  S_0 \rightarrow aS_0a\ \vline\ bS_0b\ \vline\ a\ \vline\ b\ \vline\ \epsilon
\end{align}

If we insert a character on former half of the palindrome, we can recover it back to palindrome by inserting the same character on the symmetric position on latter half of the palindrome or simply remove the newly inserted palindrome. This illustrates that insertion and deletion are equivalent. So only one operation needs to be considered.

Consider the case of $1$-close palindrome, which includes palindromes and strings that can be converted into palindromes with one operation. These langauges can be formed by introducing one unmatched pattern:
\begin{align}
  S_1 & \rightarrow aS_1a\ \vline\ bS_1b\ \vline\ bA_1\ \vline\ A_1b\  \vline\ aB_1\ \vline\ B_1a \\
  A_1 &\rightarrow aS_0a\ \vline\ bA_1b\ \vline\ a \\
  B_1 &\rightarrow bS_0b\ \vline\ aB_1a\ \vline\ b
\end{align}

Note that one $a\/b$ is inserted into a palindrome in former half or latter half. The product rule $A_1 \rightarrow a$ and $B_1 \rightarrow b$ takes even length strings into account. But if a $b$ is inserted, we should avoid the case of inserting another $b$ immediately, which is the reason why two non-terminals $A$,$B$ are used. Product rule $A_1 \rightarrow bA_1b$ is used instead of $A_1 \rightarrow bS_0b$ to avoid immediate follows of $b$, which may lead to symmetric pattern $bbbb$. The same reason holds for $B_1 \rightarrow aB_1a$.

Then, strings that is $1$-close to palindromes can be represented as  
$$
  S \rightarrow S_0 | S_1
$$

Languages that can be changed to palindromes with 2 operations can be formed by adding one layer to the former language. We don't add $A_2\rightarrow a$ and $B_2\rightarrow b$ here as it is already included in the $1$-close palindrome language:
\begin{align}
  S_2 & \rightarrow aS_2a\ \vline\ bS_2b\ \vline\ bA_2\ \vline\ A_2b\  \vline\ aB_2\ \vline\ B_2a \\
  A_2 &\rightarrow aS_1a\ \vline\ bA_2b \\
  B_2 &\rightarrow bS_1b\ \vline\ aB_2a
\end{align}
Do similarly for languages that can be changed to palindrome with 3 operations:
\begin{align}
  S_3 & \rightarrow aS_3a\ \vline\ bS_3b\ \vline\ bA_3\ \vline\ A_3b\  \vline\ aB_2\ \vline\ B_2a \\
  A_3 &\rightarrow aS_2a\ \vline\ bA_3b \\
  B_3 &\rightarrow bS_2b\ \vline\ aB_3a
\end{align}

The language that is 3-close to palindromes can thus be represented as
$$
  S \rightarrow S_0 | S_1 | S_2 | S_3
$$
where, all non-terminals and production rules are expressed in equations (1) - (10)



\question{12.B}

According to the theorem {\em Every context free language is equivalent to a grammer in Chomsky normal form}\cite{model}. Transform context free language $L$ into its Chomsky normal form. In Chomsky normal form each production rule is of the form $A\rightarrow BC \mbox{ or } A\rightarrow a$ besides those containing starting non-terminal $S$. In all cases, each single terminal symbol on the right of production rule represents a character of the langauge. If we add production rule $A\rightarrow \epsilon$ to every production rule of the form $A\rightarrow a$, the new context-free language represents subsequence($L$). So subsequence($L$) is also a context-free language.


\bibliographystyle{plain}
\bibliography{ref}


\end{document}
